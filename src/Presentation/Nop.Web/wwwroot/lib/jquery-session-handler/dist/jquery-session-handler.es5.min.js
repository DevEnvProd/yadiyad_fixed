"use strict";var SessionHandler=function(n){var t=$.extend({activityEvents:"click keypress scroll wheel mousewheel mousemove",dialogDisplayLimit:60,idleTimeLimit:1740,idleCheckTime:2,sessionTimeoutMsg:"Your session is about to expire in {0} seconds.",logoutUrl:"/logout",sessionExtensionUrl:"/token/refresh",retrieveSessionExpiryDateTimeUrl:"/token/exp"},n),f=this,r=t.idleTimeLimit,w=t.idleTimeLimit,i=null,u=new Date(9999,12,31),e=$(document).attr("title"),l=function(){store.set("idleTimerLastActivity",$.now());store.set("idleTimerLoggedOut",!1);a(function(n){o(n)})},o=function(n){u=new Date(0);u.setUTCSeconds(n);y()},a=function(n){var i={url:t.retrieveSessionExpiryDateTimeUrl,method:"get",headers:{"Content-Type":"application/json"}};$.ajax(i).done(function(t){n(t.data.exp)})},s=function(){return(u.getTime()-(new Date).getTime())/1e3},v=function(){return((new Date).getTime()-store.get("idleTimerLastActivity"))/1e3},y=function(){i=setInterval(function(){h()},t.idleCheckTime*1e3);h()},h=function(){r-=1;var n=s(),u=v(),e=store.get("idleTimerLoggedOut");n<=0||e?c():(n<t.dialogDisplayLimit+t.idleCheckTime||u>t.idleTimeLimit)&&(i&&clearInterval(i),f.showDialog())},c=function(){store.set("idleTimerLoggedOut",!0);window.location.href=t.logoutUrl},p=function(){r=t.idleTimeLimit;var n={url:t.sessionExtensionUrl,method:"get",headers:{"Content-Type":"application/json"}};$.ajax(n).done(function(n){o(n.data.exp)})};f.showDialog=function(){var u=s(),n=t.dialogDisplayLimit>u?parseInt(u):t.dialogDisplayLimit,r;clearInterval(i);r=setInterval(function(){n-=1;n>0?($(document).attr("title","Left {0}s - ".format(n)+e),swal({icon:"warning",title:"Session Timeout",text:t.sessionTimeoutMsg.format(n),buttons:{cancel:{text:"Logout",value:!1,visible:!0,className:"btn-secondary",closeModal:!0},confirm:{text:"Stay Login",value:!0,visible:!0,className:"btn-primary",closeModal:!0}},timer:2e3}).then(function(n){$(document).attr("title",e);clearInterval(r);n?p():c()})):clearInterval(r)},1e3)};$("body").on(t.activityEvents,function(){r=t.idleTimeLimit;store.set("idleTimerLastActivity",$.now())});l()};