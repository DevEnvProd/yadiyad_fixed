"use strict";var PageBankAccountDetails=function(n){var t=this,e=n.model,l=n.url,i=$(".content-bank-account"),r=i.find("#form-bank-account"),o=i.find(".btn-cancel"),a=i.find(".btn-edit"),s=i.find(".title-create"),h=i.find(".title-update"),c=!1,u=i.find(".bank-account-info"),f=i.find(".bank-account-edit");t.initDisplayComponent=function(){app.initFormComponent(r)};t.setDisplayProperty=function(t){t=t.data;e=n.model||{};e.id=t.customerId;var r=/{{([\d|\w]{1,})}}/g;t.dateOfBirthText=moment(t.dateOfBirth,"YYYY-MM-DDTHH:mm").add(timezone,"hour").format("DD MMM YYYY");i.find("[text]").each(function(){for(var n=$(this).attr("text"),i,f,u;(i=r.exec(n))!==null;)f=i[0],u=i[1],n=n.replace(f,t[u]===0?0:t[u]||"");$(this).text(n)})};t.getBankAccountData=function(n){var t={url:l.getBankAccount,method:"get",headers:{"Content-Type":"application/json"}};$.ajax(t).done(n)};t.setBankAccountData=function(n){var t,l,e;n&&n.status&&n.status.code===1&&(app.setFormValue(r,n.data),n.data&&n.data.id!==0?(t=n.data,l=/{{([\d|\w]{1,})}}/g,i.find("[text]").each(function(){for(var n=$(this).attr("text"),i,u,r;(i=l.exec(n))!==null;)u=i[0],r=i[1],n=n.replace(u,t[r]===0?0:t[r]||"");$(this).text(n)}),u.removeClass("hidden"),o.removeClass("hidden"),s.addClass("hidden"),h.removeClass("hidden"),$("[name='bankStatementDownloadId']").val(t.bankStatementDownloadId),n.data.status==="Approved"?$(".label-status").addClass("badge-success"):n.data.status==="Invalid"?$(".label-status").addClass("badge-danger"):n.data.status==="Pending"&&$(".label-status").addClass("badge-warning")):(f.removeClass("hidden"),c=!0,o.addClass("hidden"),s.removeClass("hidden"),h.addClass("hidden")),e=$('select[name="bankId"]').select2("data"),e.length&&(e[0].name=n.data.bankName))};t.submitBankAccount=function(n){var t=app.getFormValue(r),i;t.id=t.id||0;t.bankStatementDownloadId=t.bankStatementDownloadId;t.bankStatementDownloadId===""||t.bankStatementDownloadId==="0"?swal({icon:"warning",title:"Fail",text:"Please upload bank statement header to submit."}).then(function(){}):(i={url:r.attr("action"),method:r.attr("method"),headers:{"Content-Type":"application/json"},data:JSON.stringify(t)},$.ajax(i).done(n))};t.validationForm=function(){return r.valid()&&!0};t.onSubmitBankAccountResponse=function(n){n&&n.status&&n.status.code===1?swal({icon:"success",title:c?"Create Bank Account":"Update Bank Account",text:"Saved successfully"}).then(function(){location.reload()}):swal({icon:"warning",title:"Fail",text:n.status.message}).then(function(){})};t.setUserEvent=function(){r.find("button[type=submit]").on("click",function(n){n.preventDefault();n.stopPropagation();t.validationForm()&&t.submitBankAccount(t.onSubmitBankAccountResponse)});r.find(".btn-cancel").on("click",function(n){n.preventDefault();n.stopPropagation();f.addClass("hidden");u.removeClass("hidden")});i.find(".btn-edit").on("click",function(n){n.preventDefault();n.stopPropagation();u.addClass("hidden");f.removeClass("hidden")})};t.initDisplayComponent();t.getBankAccountData(t.setBankAccountData);t.setUserEvent()},pageBankAccountDetails=new PageBankAccountDetails({url:{getBankAccount:"/api/pro/bankaccount",getBankAccountPage:"/pro/account/bankaccount"}});