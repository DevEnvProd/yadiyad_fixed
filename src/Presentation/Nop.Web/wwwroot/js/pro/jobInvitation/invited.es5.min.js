"use strict";var PageJobInvited=function(n){var t=this,f=n.url,i=n.model||{},s;i.jobInvitedList=[];i.selectedJobInvite=null;var h=(new Date).getTimezoneOffset()/-60,e=new SimplePagination(".pagination-jobinvitation-invited-list"),c=$.templates("#template-card-job-invite-empty"),l=$.templates("#template-card-job-invite"),o=$.templates("#template-card-job-invite-response-detail"),a=$.templates("#template-content-job-invite-response-empty"),v=$.templates("#template-card-job-invite-empty"),r=$(".content-job-search"),u=r.find(".list-job-invited");e.onPageChanged=function(n){t.loadJobInviteData(t.setJobInvitedList,n)};t.setData=function(){var t=window.location.href,n=t.split("/");i.jobId=parseInt(n[n.length-2])||0};t.updateOrganizationJobInvitationRead=function(n,t){if(n.isRead)return!0;n.isRead=!0;var i={url:f.updateOrganizationJobInvitationRead.format(n),method:"PUT",headers:{"Content-Type":"application/json"},background:!0};$.ajax(i).done(t)};t.updateOrganizationJobInvitationReadResponse=function(){};t.loadJobInviteData=function(n,t){var r={keyword:"",jobProfileId:i.jobId},u=10,s=t?t*u:0,e={filter:r.keyword,offset:s,recordSize:u,sorting:null,advancedFilter:r},o;i.search=e;o={url:f.getJobInvited,method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)};$.ajax(o).done(n)};t.replyJobInvite=function(n,t){var r=i.selectedJobInvite.id,u={JobInvitationStatus:n},e={url:f.replyJobInvite.format({id:r}),method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(u)};$.ajax(e).done(t)};t.setJobInvitedList=function(n){t.handleResponse(n,function(n){var f,s;r.bindText(n.data);$.each(n.data.data,function(n,t){t.serviceIndividualProfile&&t.serviceIndividualProfile.dateOfBirth!==null&&(t.serviceIndividualProfile.dateOfBirth=moment(t.serviceIndividualProfile.dateOfBirth,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));t.jobSeekerProfile.tenureStart!==null&&(t.jobSeekerProfile.tenureStart=moment(t.jobSeekerProfile.tenureStart,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));t.jobSeekerProfile.tenureEnd!==null&&(t.jobSeekerProfile.tenureEnd=moment(t.jobSeekerProfile.tenureEnd,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));t.createdOn=moment(t.createdOnUTC,"YYYY-MM-DDTHH:mm").add(h,"hour").format("DD MMM YYYY");t.startDate=moment(t.jobProfile.startDate,"YYYY-MM-DD").add(0,"hour").format("DD MMM YYYY");t.jobSeekerProfile.jobTypes=[];t.jobSeekerProfile.isFreelanceDaily&&t.jobSeekerProfile.jobTypes.push("Freelance (Daily)");t.jobSeekerProfile.isFreelanceHourly&&t.jobSeekerProfile.jobTypes.push("Freelance (Hourly)");t.jobSeekerProfile.isProjectBased&&t.jobSeekerProfile.jobTypes.push("Project-Based");t.jobSeekerProfile.jobTypeNames=t.jobSeekerProfile.jobTypes.join(", ");t.jobSeekerProfile.jobModels=[];t.jobSeekerProfile.isOnSite&&t.jobSeekerProfile.jobModels.push("Onsite");t.jobSeekerProfile.isPartialOnSite&&t.jobSeekerProfile.jobModels.push("Partial Onsite");t.jobSeekerProfile.isRemote&&t.jobSeekerProfile.jobModels.push("Remote");t.jobSeekerProfile.jobModelNames=t.jobSeekerProfile.jobModels.join(", ")});!i.selectedJobInvite&&n.data.data&&n.data.data.length>0&&(i.selectedJobInvite=n.data.data[0],t.updateOrganizationJobInvitationRead(i.selectedJobInvite,t.updateOrganizationJobInvitationReadResponse),i.selectedJobInvite.isSelected=!0,f=o.render(i.selectedJobInvite),r.find(".content-job-invited").replaceWith(f));n.data.data.length>0?(s=l.render(n.data.data),u.empty(),e.set(n.data),u.append(s),i.jobInvitedList=i.jobInvitedList.concat(n.data.data)):(r.replaceWith(c),u.empty(),e.set(n.data),u.append(v),r.find(".content-job-invited").replaceWith(a))})};t.setJobInviteResponse=function(n){var f=$(n).data("entity-id"),e=$.grep(i.jobInvitedList,function(n){return n.id===f}),u;$(n).parent().children(".selected").removeClass("selected");$(n).addClass("selected");i.selectedJobInvite=e[0];t.updateOrganizationJobInvitationRead(i.selectedJobInvite,t.updateOrganizationJobInvitationReadResponse);i.selectedJobInvite.isSelected=!0;u=o.render(i.selectedJobInvite);r.find(".content-job-invited").replaceWith(u)};t.responseJobInviteUpdates=function(n){t.handleResponse(n,function(){u.empty();i.selectedJobInvite=null;t.loadJobInviteData(t.setJobInvitedList)})};t.handleResponse=function(n,t){n&&n.status&&n.status.code===1?t(n):swal({icon:"warning",title:"Fail",text:n.status.message}).then(function(){})};t.setUserEvent=function(){u.on("click",".card-job-invite",function(){t.setJobInviteResponse(this)})};s=function(){t.setData();t.loadJobInviteData(t.setJobInvitedList);t.setUserEvent()};s()},pageJobInvited=new PageJobInvited({url:{getJobInvited:"/api/pro/jobinvitation/inviteds",replyJobInvite:"/api/pro/jobinvitation/{{id}}",updateOrganizationJobInvitationRead:"/api/pro/jobinvitation/{{id}}/org/read"}});