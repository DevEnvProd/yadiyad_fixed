"use strict";var PageJobCandidate=function(n){var t=this,e=n.url,i=n.model||{},s;i.jobCandidateList=[];i.selectedJobCandidate=null;var v=(new Date).getTimezoneOffset()/-60,f=new SimplePagination(".pagination-job-candidate-list"),h=$.templates("#template-card-job-candidate-empty"),c=$.templates("#template-card-job-candidate"),o=$.templates("#template-card-job-candidate-response-detail"),l=$.templates("#template-content-job-candidate-response-empty"),a=$.templates("#template-card-job-candidate-empty"),r=$(".content-job-search"),u=r.find(".list-job-candidate");f.onPageChanged=function(n){t.loadJobCandidateData(t.setJobCandidateList,n)};t.getModel=function(){return i};t.setData=function(){var t=window.location.href,n=t.split("/");i.id=parseInt(n[n.length-2])||0;i.selectedJobApplicationId=i.id};t.loadJobCandidateData=function(n,t){var r={JobProfileId:i.id},u=10,s=t?t*u:0,f={filter:r.keyword,offset:s,recordSize:u,sorting:null,advancedFilter:r},o;i.search=f;o={url:e.searchJobCandidate,method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(f)};$.ajax(o).done(n)};t.setJobCandidateList=function(n){t.handleResponse(n,function(n){var e,s;if(r.bindText(n.data),$.each(n.data.data,function(t,r){r.dob!==null&&(r.dob=moment(r.dob,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));r.tenureStart!==null&&(r.tenureStart=moment(r.tenureStart,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));r.tenureEnd!==null&&(r.tenureEnd=moment(r.tenureEnd,"YYYY-MM-DDTHH:mm").add(0,"hour").format("DD MMM YYYY"));i.viewJobCandidateFullProfileSubscriptionEndDays<=0&&(r.name=r.code);r.showFullProfile=n.data.additionalData.showFullProfile;r.jobTypes=[];r.isFreelanceDaily&&r.jobTypes.push("Freelance (Daily)");r.isFreelanceHourly&&r.jobTypes.push("Freelance (Hourly)");r.isProjectBased&&r.jobTypes.push("Project-Based");r.jobTypeNames=r.jobTypes.join(", ");r.jobModels=[];r.isOnSite&&r.jobModels.push("Onsite");r.isPartialOnSite&&r.jobModels.push("Partial Onsite");r.isRemote&&r.jobModels.push("Remote");r.jobModelNames=r.jobModels.join(", ");r.index=t+1+n.data.pageIndex*n.data.pageSize}),n.data.additionalData.showFullProfile!==!0&&$(".section-subscription-pay").removeClass("hidden"),!i.selectedJobCandidate&&n.data.data&&n.data.data.length>0){i.selectedJobCandidate=n.data.data[0];i.selectedJobCandidate.isSelected=!0;e=o.render(i.selectedJobCandidate);r.find(".content-job-candidate").replaceWith(e);r.find(".content-job-candidate").on("click",".btn-invite",function(){t.inviteCandidate(this,t.responseInviteCandidate)})}n.data.data.length>0?(s=c.render(n.data.data),u.empty(),f.set(n.data),u.append(s),i.jobCandidateList=i.jobCandidateList.concat(n.data.data)):(r.replaceWith(h),u.empty(),f.set(n.data),u.append(a),r.find(".content-job-candidate").replaceWith(l))})};t.setJobCandidateResponse=function(n){var f=$(n).data("entity-id"),e=$.grep(i.jobCandidateList,function(n){return n.id===f}),u;$(n).parent().children(".selected").removeClass("selected");$(n).addClass("selected");i.selectedJobCandidate=e[0];i.selectedJobCandidate.isSelected=!0;u=o.render(i.selectedJobCandidate);r.find(".content-job-candidate").replaceWith(u);r.find(".content-job-candidate").on("click",".btn-invite",function(){t.inviteCandidate(this,t.responseInviteCandidate)})};t.inviteCandidate=function(n,t){var f=$(n).closest(".content-job-candidate").data("entity-id"),r={},u;r.jobSeekerProfileId=f;r.jobProfileId=i.id;u={url:e.inviteCandidate,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(r)};$.ajax(u).done(t)};t.responseInviteCandidate=function(n){t.handleResponse(n,function(){swal({icon:"success",title:"Job Invitation sent to Candidate"}).then(function(){location.reload()})})};t.handleResponse=function(n,t){n&&n.status&&n.status.code===1?t(n):swal({icon:"warning",title:"Fail",text:n.status.message}).then(function(){})};t.setUserEvent=function(){u.on("click",".card-job-candidate",function(){t.setJobCandidateResponse(this)})};s=function(){t.setData();t.loadJobCandidateData(t.setJobCandidateList);t.setUserEvent()};s()},pageJobCandidate=new PageJobCandidate({url:{searchJobCandidate:"/api/pro/job/candidate",inviteCandidate:"/api/pro/jobInvitation/invite",getJobProfile:"/api/pro/job/{{id}}"}});