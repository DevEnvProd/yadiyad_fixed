"use strict";var PageIndividualProfileDetails=function(n){var t=this,c=n.model,u=n.url,r=$(".content-individual-profile"),i=r.find("#form-individual-profile"),f=r.find(".area-agreement"),e=r.find(".btn-cancel"),o=r.find(".title-create"),s=r.find(".title-update"),h=!1;t.initDisplayComponent=function(){app.initFormComponent(i)};t.getIndividualProfileData=function(n){var t={url:u.getIndividualProfile,method:"get",headers:{"Content-Type":"application/json"}};$.ajax(t).done(n)};t.setIndividualProfileData=function(n){var t,r,u,c,l,a,v,y;n&&n.status&&n.status.code===1&&(n.data.billingAddress===null&&(n.data.billingAddress={countryId:131,countryName:"Malaysia"}),app.setFormValue(i,n.data),n.data.id!==0?(f.addClass("hidden"),e.removeClass("hidden"),o.addClass("hidden"),s.removeClass("hidden")):(h=!0,f.removeClass("hidden"),e.addClass("hidden"),o.removeClass("hidden"),s.addClass("hidden")),t=!0,n.data.billingAddress.address1!=n.data.address1?t=!1:n.data.billingAddress.address2!=n.data.address2?t=!1:n.data.billingAddress.cityId!=n.data.cityId?t=!1:n.data.billingAddress.countryId!=n.data.countryId?t=!1:n.data.billingAddress.stateProvinceId!=n.data.stateProvinceId?t=!1:n.data.billingAddress.zipPostalCode!=n.data.zipPostalCode&&(t=!1),t==!0?($("#sameAddress").prop("checked",!0),$(".billing-section").hide()):($("#sameAddress").prop("checked",!1),$(".billing-section").show()),r=$('select[name="title"]').select2("data"),r.length&&(r[0].code=n.data.title),u=$('select[name="nationalityId"]').select2("data"),u.length&&(u[0].code=n.data.nationalityId),c=$('select[name="stateProvinceId"]').select2("data"),c.length&&(c[0].code=n.data.stateProvinceId),l=$('select[name="countryId"]').select2("data"),l.length&&(l[0].code=n.data.countryId),n.data.billingAddress!==null&&(a=$('select[name="billingAddress.cityId"]').select2("data"),a.length&&(a[0].code=n.data.billingAddress.cityId),v=$('select[name="billingAddress.stateProvinceId"]').select2("data"),v.length&&(v[0].code=n.data.billingAddress.stateProvinceId),y=$('select[name="billingAddress.countryId"]').select2("data"),y.length&&(y[0].code=n.data.billingAddress.countryId)))};t.submitIndividualProfile=function(n){var t=app.getFormValue(i),r;t.address=[t.address1,t.address2,t.zipPostalCode].filter(Boolean).join(", ");t.billingAddress=$("#sameAddress").prop("checked")==!0?{address1:t.address1,address2:t.address2,cityId:t.cityId,stateProvinceId:t.stateProvinceId,countryId:t.countryId,zipPostalCode:t.zipPostalCode}:{address1:t["billingAddress.address1"],address2:t["billingAddress.address2"],cityId:t["billingAddress.cityId"],stateProvinceId:t["billingAddress.stateProvinceId"],countryId:t["billingAddress.countryId"],zipPostalCode:t["billingAddress.zipPostalCode"]};r={url:i.attr("action"),method:i.attr("method"),headers:{"Content-Type":"application/json"},data:JSON.stringify(t)};$.ajax(r).done(n)};t.validationForm=function(){return i.valid()&&!0};t.onSubmitIndividualProfileResponse=function(n){n&&n.status&&n.status.code===1?swal({icon:"success",title:h?"Create Individual Profile":"Update Individual Profile",text:"Saved successfully"}).then(function(){location.href=u.getIndividualProfilePage}):swal({icon:"warning",title:"Fail",text:n.status.message}).then(function(){})};t.setUserEvent=function(){i.find(".btn-cancel").on("click",function(n){n.preventDefault();n.stopPropagation();location.href=u.getIndividualProfilePage});i.on("submit",function(n){n.preventDefault();n.stopPropagation();t.validationForm()&&t.submitIndividualProfile(t.onSubmitIndividualProfileResponse)});$("#sameAddress").click(function(){$(this).prop("checked")==!0?$(".billing-section").hide():$(".billing-section").show()})};t.initDisplayComponent();t.getIndividualProfileData(t.setIndividualProfileData);t.setUserEvent()},pageIndividualProfileDetails=new PageIndividualProfileDetails({url:{getIndividualProfile:"/api/pro/individual",getIndividualProfilePage:"/pro/individual",getIndividualCreateServicePage:"/pro/service/details"}});