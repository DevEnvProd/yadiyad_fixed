"use strict";var WeeklyScheduler=function(n,t,i,r,u){function rt(n,t,i,r){return n<i&&i<t?!0:n<r&&r<t?!0:i<n&&t<r?!0:i.getTime()===n.getTime()&&t.getTime()===r.getTime()?!0:!1}function w(n,t){var i=[],r=moment(n.start.toUTCString());return t||i.push("<strong>"+r.format("HH:mm")+"<\/strong> "),n.isPrivate?(i.push('<span class="calendar-font-icon ic-lock-b"><\/span>'),i.push(" Private")):(n.isReadOnly?i.push('<span class="calendar-font-icon ic-readonly-b"><\/span>'):n.recurrenceRule?i.push('<span class="calendar-font-icon ic-repeat-b"><\/span>'):n.attendees.length?i.push('<span class="calendar-font-icon ic-user-b"><\/span>'):n.location&&i.push('<span class="calendar-font-icon ic-location-b"><\/span>'),i.push(" "+n.title)),i.join("")}function ut(n){var t=g(n.target);switch(t){case"move-prev":f.prev();break;case"move-next":f.next();break;case"move-today":f.today();break;default:return}k();d()}function ft(n){var t=$(n.target).closest('a[role="menuitem"]')[0],i=g(t);et(i)}function et(n){var r=document.getElementById("calendarName"),t=findCalendar(n),i=[];i.push('<span class="calendar-bar" style="background-color: '+t.bgColor+"; border-color:"+t.borderColor+';"><\/span>');i.push('<span class="calendar-name">'+t.name+"<\/span>");r.innerHTML=i.join("");it=t}function ot(n){var t=n.calendar||findCalendar(n.calendarId),i={id:String(chance.guid()),title:n.title,isAllDay:n.isAllDay,start:n.start,end:n.end,category:n.isAllDay?"allday":"time",dueDateClass:"",bgColor:t.bgColor,dragBgColor:t.bgColor,borderColor:t.borderColor,location:n.location,raw:{},state:n.state};t&&(i.calendarId=t.id,i.color=t.color,i.bgColor=t.bgColor,i.borderColor=t.borderColor);f.createSchedules([i]);c()}function c(){var n=Array.prototype.slice.call(document.querySelectorAll("#calendarList input"));CalendarList.forEach(function(n){f.toggleSchedules(n.id,!n.checked,!1)});f.render(!0);n.forEach(function(n){var t=n.nextElementSibling;t.style.backgroundColor=n.checked?t.style.borderColor:"transparent"})}function b(n){var t=moment([f.getDate().getFullYear(),f.getDate().getMonth(),f.getDate().getDate()]);return t.format(n)}function k(){var t=document.getElementById("renderRange");if(t){var i=f.getOptions(),r=f.getViewName(),n=[];r==="day"?n.push(b("DD MMM YYYY")):r==="month"&&(!i.month.visibleWeeksCount||i.month.visibleWeeksCount>4)?n.push(b("MMM YYYY")):(n.push(moment(f.getDateRangeStart().getTime()).format("DD MMM YYYY")),n.push(" - "),n.push(moment(f.getDateRangeEnd().getTime()).format("DD MMM YYYY")));t.innerHTML=n.join("")}}function d(){c()}function st(){$("#menu-navi").on("click",ut);$("#dropdownMenu-calendars-list").on("click",ft);window.addEventListener("resize",p)}function g(n){return n.dataset?n.dataset.action:n.getAttribute("data-action")}var e=this,nt=tui.Calendar,f,p,tt=!0&&!t,it,h=!1,o={MONTHLY:"monthly",WEEKLY:"weekly",WEEK:"week"},s,v,y,l,a;i===o.MONTHLY&&(h=!0);s={minDate:null,maxDate:null};f=new nt(n,{isReadOnly:t&&!0,usageStatistics:!1,defaultView:i&&i==o.MONTHLY?"month":"week",useCreationPopup:!1,useDetailPopup:tt,calendars:CalendarList,taskView:[],scheduleView:["time"],template:{milestone:function(n){return'<span class="calendar-font-icon ic-milestone-b"><\/span> <span style="background-color: '+n.bgColor+'">'+n.title+"<\/span>"},allday:function(n){return w(n,!0)},time:function(n){return w(n,!1)}},week:{customDateRange:r,hourStart:u&&u.hourStart||0,hourEnd:u&&u.hourEnd||24}});Object.defineProperty(e,"Calendar",{get:function(){return f}});$(n).on("click",function(n){n.preventDefault();n.stopPropagation()});v=function(n){var i=s.minDate&&new Date(s.minDate),t=s.maxDate&&new Date(s.maxDate);return i&&t&&(t.setDate(t.getDate()+1),i&&i>n.start._date||t&&t<n.start._date||i&&i>n.end._date||t&&t<n.end._date)?(n.guide&&n.guide.clearGuideElement(),!1):!0};y=function(n){var t=!1;return $.each(f._controller.schedules.items,function(i,r){if(rt(n.start._date,n.end._date,r.start._date,r.end._date)&&(!n.schedule||n.schedule&&n.schedule.id!==r.id))return t=!0,!1}),t===!1};f.on({clickMore:function(n){console.log("clickMore",n)},clickSchedule:function(n){console.log("clickSchedule",n)},clickDayname:function(n){console.log("clickDayname",n)},beforeCreateSchedule:function(n){console.log("beforeCreateSchedule",n);v(n)&&y(n)?(ot(n),e.onChanged&&e.onChanged(n)):c()},beforeUpdateSchedule:function(n){var i=n.schedule,t=n.changes;if(!t)return!0;console.log("beforeUpdateSchedule",n);t&&!t.isAllDay&&i.category==="allday"&&(t.category="time");v(n)&&y(n)?f.updateSchedule(i.id,i.calendarId,t):f.deleteSchedule(n.schedule.id,n.schedule.calendarId);c();e.onChanged&&e.onChanged(n)},beforeDeleteSchedule:function(n){console.log("beforeDeleteSchedule",n);f.deleteSchedule(n.schedule.id,n.schedule.calendarId);e.onChanged&&e.onChanged(n)},afterRenderSchedule:function(n){var t=n.schedule,i=f.getElement(t.id,t.calendarId);console.log("afterRenderSchedule",i)},afterRender:function(n){console.log("afterRender",n)},clickTimezonesCollapseBtn:function(n){return console.log("timezonesCollapsed",n),n?f.setTheme({"week.daygridLeft.width":"77px","week.timegridLeft.width":"77px"}):f.setTheme({"week.daygridLeft.width":"60px","week.timegridLeft.width":"60px"}),!0}});p=tui.util.throttle(function(){f.render()},50);e.setDate=function(n){f.setDate(n)};e.setEnabledDateRange=function(n,t,i){var r=f.getOptions();s.minDate=t;s.maxDate=i;r.customDateRange={renderStartDate:t,renderEndDate:i};e.setViewMode(n)};e.setSchedule=function(n,t){var r=findCalendar(undefined),e,i,o,s,u,l;f.clear();e=[];i=[];n.forEach(function(n){var t={id:String(chance.guid()),isAllDay:h,isReadOnly:n.isReadOnly&&!0,start:n.start,end:n.end,category:h?"allday":"time",dueDateClass:"",color:r.color,bgColor:r.bgColor,dragBgColor:r.bgColor,borderColor:r.borderColor,raw:{}};i.push(n.start);e.push(t)});i=i.sort(function(n,t){return new Date(t.date)-new Date(n.date)});o=i[0];f.createSchedules(e);t||f.setDate(o);c();s=moment(o).format("h a");u=$(".tui-full-calendar-timegrid-hour").filter(function(){return $(this).text().trim()===s});u&&u.length>0&&(l=u[0].offsetTop-20,setTimeout(function(){$(".tui-full-calendar-timegrid-container").scrollTop(l)},300))};e.setViewMode=function(t){var r=f.getOptions(),i="";$(n).removeClass("tui-layout-"+o.WEEKLY).removeClass("tui-layout-"+o.WEEK).removeClass("tui-layout-"+o.MONTHLY);switch(t){case o.WEEKLY:$(n).addClass("tui-layout-"+o.WEEKLY);i="week";h=!1;break;case o.WEEK:i="week";h=!1;$(n).addClass("tui-layout-"+o.WEEK);break;case o.MONTHLY:$(n).addClass("tui-layout-"+o.MONTHLY);r.month.visibleWeeksCount=0;i="month";h=!0}f.setOptions(r,!0);f.changeView(i,!0);c()};window.cal=f;i===o.WEEK&&(l=new Date,l.setYear(1990),l.setMonth(0),l.setDate(1),l.setHours(0,0,0,0),a=new Date,a.setYear(1990),a.setMonth(0),a.setDate(7),a.setHours(23,59,59,99),e.setEnabledDateRange("week",l,a));k();d();st()};