"use strict";var PageRequestService=function(n){var t=this,e=".content-consultation-moderator-complete",i=n.url,r={},u={},f=n.model||{selectedConsultationInvitation:null,setCandidateResult:function(n){return pagination.set(n),n&&n.data&&$.each(n.data,function(n,t){t.createdOnText=moment(t.createdOnUTC,"YYYY-MM-DDTHH:mm").add(timezone,"hour").format("DD MMM YYYY");$.each(t.consultantAvailableTimeSlots,function(n,t){t.startDateText=moment(t.startDate,"YYYY-MM-DDTHH:mm").add(timezone,"hour").format("DD/MM/YYYY");t.startTimeText=moment(t.startDate,"YYYY-MM-DDTHH:mm").add(timezone,"hour").format("hh:mma");t.endTimeText=moment(t.endDate,"YYYY-MM-DDTHH:mm").add(timezone,"hour").format("hh:mma")})}),$.observable(this.applicants).setProperty(n),this.applicants.data&&this.applicants.data.length>0&&($.observable(this).setProperty("selectedConsultationInvitation",this.applicants.data[0]),$.observable(this.applicants.data[0]).setProperty("selected",!0),$("input.rating[type=number], div.rating").each(function(){$(this).rating({iconLib:"",inactiveIcon:"far fa-star",activeIcon:"fa fa-star"})})),!1},showApplicantDetail:function(){return $.observable(this.selectedConsultationInvitation).setProperty("showMore",!0),!1},showReviewForm:function(){var n=this;return $("input.rating[type=number], div.rating").each(function(){$(this).rating({iconLib:"",inactiveIcon:"far fa-star",activeIcon:"fa fa-star",additionalClasses:"cursor-pointer"}).on("change",function(){var n=$(this).attr("name"),t=$(this).val();r[n]=t})}),$("input.organization-rating[type=number], div.rating").each(function(){$(this).rating({iconLib:"",inactiveIcon:"far fa-star",activeIcon:"fa fa-star",additionalClasses:"cursor-pointer"}).on("change",function(){var n=$(this).attr("name"),t=$(this).val();u[n]=t})}),!1},publishReview:function(){var n,i,f,e;if($("#messageModeratorReviewStars").attr("hidden",!0),$("#messageOrganizationReviewStars").attr("hidden",!0),n=$("#showConsultantRating").is(":checked"),n&&(i=Object.keys(u).length,i<5)){$("#messageOrganizationReviewStars").removeAttr("hidden");return}if(f=Object.keys(r).length,f<5){$("#messageModeratorReviewStars").removeAttr("hidden");return}return e={Dict:r,OrganizationRating:u,Remarks:$("#textReview").val(),OrganizationRemarks:$("#textOrganizationReview").val(),Id:$("#Id").val()},t.reviewConsultationInvitation(e,t.reviewConsultationInvitationResponse),!1}};t.reviewConsultationInvitation=function(n,t){var r={url:i.submitCompleteConsultationInvitation,method:"post",headers:{"Content-Type":"application/json"},data:JSON.stringify(n)};$.ajax(r).done(t)};t.getConsultationInvitationList=function(n){var t={url:i.getConsultationInvitationList,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(data)};$.ajax(t).done(n)};t.setConsultationInvitationList=function(n){t.handleResponse(n,function(n){f.setCandidateResult(n.data)})};t.reviewConsultationInvitationResponse=function(n){n&&n.status&&n.status.code===1?swal({icon:"success",title:"Consultation Completed Succesfully "}).then(function(){location.href=i.getReturnUrl}):swal({icon:"warning",title:"Fail",text:n.status.message}).then(function(){location.href=i.getReturnUrl})};$.templates({tmplConsultationModeratorComplete:"#tmpl-consultation-moderator-complete"});var o=function(){},s=function(){},h=function(){s();$.templates.tmplConsultationModeratorComplete.link(e,f);o();f.showReviewForm()};h()},pageRequestService=new PageRequestService({url:{submitCompleteConsultationInvitation:"/api/pro/consultationinvitation/complete/",getReturnUrl:"/pro/consultation/facilitating"}});